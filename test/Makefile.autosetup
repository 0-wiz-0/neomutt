TEST_OBJS   = test/main.o \
	      test/base64.o \
	      test/buffer.o \
	      test/md5.o \
	      test/rfc2047.o \
	      test/address.o \
	      test/url.o \
	      test/file.o

ADDRESS_OBJS	= test/address/main.o \
		  test/address/mutt_addr_append.o \
		  test/address/mutt_addr_cat.o \
		  test/address/mutt_addr_cmp.o \
		  test/address/mutt_addr_cmp_strict.o \
		  test/address/mutt_addr_copy.o \
		  test/address/mutt_addr_copy_list.o \
		  test/address/mutt_addr_for_display.o \
		  test/address/mutt_addr_free.o \
		  test/address/mutt_addr_has_recips.o \
		  test/address/mutt_addr_is_intl.o \
		  test/address/mutt_addr_is_local.o \
		  test/address/mutt_addrlist_to_intl.o \
		  test/address/mutt_addrlist_to_local.o \
		  test/address/mutt_addr_mbox_to_udomain.o \
		  test/address/mutt_addr_new.o \
		  test/address/mutt_addr_parse_list2.o \
		  test/address/mutt_addr_parse_list.o \
		  test/address/mutt_addr_qualify.o \
		  test/address/mutt_addr_remove_from_list.o \
		  test/address/mutt_addr_remove_xrefs.o \
		  test/address/mutt_addr_search.o \
		  test/address/mutt_addr_set_intl.o \
		  test/address/mutt_addr_set_local.o \
		  test/address/mutt_addr_valid_msgid.o \
		  test/address/mutt_addr_write.o \
		  test/address/mutt_addr_write_single.o

BASE64_OBJS	= test/base64/main.o \
		  test/base64/mutt_b64_buffer_decode.o \
		  test/base64/mutt_b64_buffer_encode.o \
		  test/base64/mutt_b64_decode.o \
		  test/base64/mutt_b64_encode.o

BUFFER_OBJS	= test/buffer/main.o \
		  test/buffer/mutt_buffer_addch.o \
		  test/buffer/mutt_buffer_add_printf.o \
		  test/buffer/mutt_buffer_addstr.o \
		  test/buffer/mutt_buffer_addstr_n.o \
		  test/buffer/mutt_buffer_alloc.o \
		  test/buffer/mutt_buffer_concat_path.o \
		  test/buffer/mutt_buffer_fix_dptr.o \
		  test/buffer/mutt_buffer_free.o \
		  test/buffer/mutt_buffer_from.o \
		  test/buffer/mutt_buffer_increase_size.o \
		  test/buffer/mutt_buffer_init.o \
		  test/buffer/mutt_buffer_is_empty.o \
		  test/buffer/mutt_buffer_len.o \
		  test/buffer/mutt_buffer_new.o \
		  test/buffer/mutt_buffer_pool_free.o \
		  test/buffer/mutt_buffer_pool_get.o \
		  test/buffer/mutt_buffer_pool_release.o \
		  test/buffer/mutt_buffer_printf.o \
		  test/buffer/mutt_buffer_reset.o \
		  test/buffer/mutt_buffer_strcpy.o \
		  test/buffer/mutt_buffer_strcpy_n.o

CHARSET_OBJS	= test/charset/main.o \
		  test/charset/mutt_ch_canonical_charset.o \
		  test/charset/mutt_ch_charset_lookup.o \
		  test/charset/mutt_ch_check.o \
		  test/charset/mutt_ch_check_charset.o \
		  test/charset/mutt_ch_choose.o \
		  test/charset/mutt_ch_chscmp.o \
		  test/charset/mutt_ch_convert_nonmime_string.o \
		  test/charset/mutt_ch_convert_string.o \
		  test/charset/mutt_ch_fgetconv.o \
		  test/charset/mutt_ch_fgetconv_close.o \
		  test/charset/mutt_ch_fgetconv_open.o \
		  test/charset/mutt_ch_fgetconvs.o \
		  test/charset/mutt_ch_get_default_charset.o \
		  test/charset/mutt_ch_get_langinfo_charset.o \
		  test/charset/mutt_ch_iconv.o \
		  test/charset/mutt_ch_iconv_lookup.o \
		  test/charset/mutt_ch_iconv_open.o \
		  test/charset/mutt_ch_lookup_add.o \
		  test/charset/mutt_ch_lookup_remove.o \
		  test/charset/mutt_ch_set_charset.o

CONFIG_OBJS	= test/config/main.o test/config/account.o \
		  test/config/address.o test/config/bool.o \
		  test/config/command.o test/config/common.o test/config/dump.o \
		  test/config/initial.o test/config/long.o \
		  test/config/magic.o test/config/mbtable.o \
		  test/config/number.o test/config/path.o test/config/quad.o \
		  test/config/regex.o test/config/set.o test/config/sort.o \
		  test/config/string.o test/config/synonym.o

DATE_OBJS	= test/date/main.o \
		  test/date/mutt_date_add_timeout.o \
		  test/date/mutt_date_check_month.o \
		  test/date/mutt_date_gmtime.o \
		  test/date/mutt_date_is_day_name.o \
		  test/date/mutt_date_localtime.o \
		  test/date/mutt_date_localtime_format.o \
		  test/date/mutt_date_local_tz.o \
		  test/date/mutt_date_make_date.o \
		  test/date/mutt_date_make_imap.o \
		  test/date/mutt_date_make_time.o \
		  test/date/mutt_date_make_tls.o \
		  test/date/mutt_date_normalize_time.o \
		  test/date/mutt_date_parse_date.o \
		  test/date/mutt_date_parse_imap.o

GROUP_OBJS	= test/group/main.o \
		  test/group/mutt_grouplist_add_addrlist.o \
		  test/group/mutt_grouplist_add.o \
		  test/group/mutt_grouplist_add_regex.o \
		  test/group/mutt_grouplist_clear.o \
		  test/group/mutt_grouplist_destroy.o \
		  test/group/mutt_grouplist_free.o \
		  test/group/mutt_grouplist_init.o \
		  test/group/mutt_grouplist_remove_addrlist.o \
		  test/group/mutt_grouplist_remove_regex.o \
		  test/group/mutt_group_match.o \
		  test/group/mutt_pattern_group.o

IDNA_OBJS	= test/idna/main.o \
		  test/idna/mutt_idna_intl_to_local.o \
		  test/idna/mutt_idna_local_to_intl.o \
		  test/idna/mutt_idna_print_version.o \
		  test/idna/mutt_idna_to_ascii_lz.o

PATH_OBJS	= test/path/main.o \
		  test/path/mutt_path_abbr_folder.o \
		  test/path/mutt_path_basename.o \
		  test/path/mutt_path_canon.o \
		  test/path/mutt_path_concat.o \
		  test/path/mutt_path_concatn.o \
		  test/path/mutt_path_dirname.o \
		  test/path/mutt_path_escape.o \
		  test/path/mutt_path_getcwd.o \
		  test/path/mutt_path_parent.o \
		  test/path/mutt_path_pretty.o \
		  test/path/mutt_path_realpath.o \
		  test/path/mutt_path_tidy.o \
		  test/path/mutt_path_tidy_dotdot.o \
		  test/path/mutt_path_tidy_slash.o \
		  test/path/mutt_path_to_absolute.o

PATTERN_OBJS	= test/pattern/main.o \
		  test/pattern/comp.o \
		  test/pattern/dummy.o \
		  test/pattern/extract.o \
		  pattern.o

STRING_OBJS	= test/string/main.o \
		  test/string/mutt_str_adjust.o \
		  test/string/mutt_str_append_item.o \
		  test/string/mutt_str_asprintf.o \
		  test/string/mutt_str_atoi.o \
		  test/string/mutt_str_atol.o \
		  test/string/mutt_str_atos.o \
		  test/string/mutt_str_atoui.o \
		  test/string/mutt_str_atoul.o \
		  test/string/mutt_str_atoull.o \
		  test/string/mutt_str_dequote_comment.o \
		  test/string/mutt_str_find_word.o \
		  test/string/mutt_str_getenv.o \
		  test/string/mutt_str_inline_replace.o \
		  test/string/mutt_str_is_ascii.o \
		  test/string/mutt_str_is_email_wsp.o \
		  test/string/mutt_str_lws_len.o \
		  test/string/mutt_str_lws_rlen.o \
		  test/string/mutt_str_next_word.o \
		  test/string/mutt_str_pretty_size.o \
		  test/string/mutt_str_remall_strcasestr.o \
		  test/string/mutt_str_remove_trailing_ws.o \
		  test/string/mutt_str_replace.o \
		  test/string/mutt_str_rstrnstr.o \
		  test/string/mutt_str_skip_email_wsp.o \
		  test/string/mutt_str_skip_whitespace.o \
		  test/string/mutt_str_split.o \
		  test/string/mutt_str_startswith.o \
		  test/string/mutt_str_strcasecmp.o \
		  test/string/mutt_str_strcasestr.o \
		  test/string/mutt_str_strcat.o \
		  test/string/mutt_str_strchrnul.o \
		  test/string/mutt_str_strcmp.o \
		  test/string/mutt_str_strcoll.o \
		  test/string/mutt_str_strdup.o \
		  test/string/mutt_str_strfcpy.o \
		  test/string/mutt_str_stristr.o \
		  test/string/mutt_str_strlen.o \
		  test/string/mutt_str_strlower.o \
		  test/string/mutt_str_strncasecmp.o \
		  test/string/mutt_str_strncat.o \
		  test/string/mutt_str_strncmp.o \
		  test/string/mutt_str_strnfcpy.o \
		  test/string/mutt_str_substr_cpy.o \
		  test/string/mutt_str_substr_dup.o \
		  test/string/mutt_str_sysexit.o \
		  test/string/mutt_str_word_casecmp.o

CFLAGS	+= -I$(SRCDIR)/test

TEST_BINARY = test/neomutt-test$(EXEEXT)

TEST_ADDRESS = test/address-test$(EXEEXT)

TEST_BASE64 = test/base64-test$(EXEEXT)

TEST_BUFFER = test/buffer-test$(EXEEXT)

TEST_CHARSET = test/charset-test$(EXEEXT)

TEST_CONFIG = test/config-test$(EXEEXT)

TEST_DATE = test/date-test$(EXEEXT)

TEST_GROUP = test/group-test$(EXEEXT)

TEST_IDNA = test/idna-test$(EXEEXT)

TEST_PATH = test/path-test$(EXEEXT)

TEST_PATTERN = test/pattern-test$(EXEEXT)

TEST_STRING = test/string-test$(EXEEXT)

.PHONY: test
test: $(TEST_BINARY) $(TEST_ADDRESS) $(TEST_BASE64) $(TEST_BUFFER) $(TEST_CHARSET) $(TEST_CONFIG) $(TEST_DATE) $(TEST_GROUP) $(TEST_IDNA) $(TEST_PATH) $(TEST_PATTERN) $(TEST_STRING)
	$(TEST_BINARY)
	$(TEST_ADDRESS)
	$(TEST_BASE64)
	$(TEST_BUFFER)
	$(TEST_CONFIG)
	$(TEST_DATE)
	$(TEST_GROUP)
	$(TEST_IDNA)
	$(TEST_PATH)
	$(TEST_PATTERN)
	$(TEST_STRING)

$(TEST_BINARY): $(TEST_OBJS) $(MUTTLIBS)
	$(CC) -o $@ $(TEST_OBJS) $(MUTTLIBS) $(LDFLAGS) $(LIBS)

$(TEST_ADDRESS): $(PWD)/test/address $(ADDRESS_OBJS) $(MUTTLIBS)
	$(CC) -o $@ $(ADDRESS_OBJS) $(MUTTLIBS) $(LDFLAGS) $(LIBS)

$(TEST_BASE64): $(PWD)/test/base64 $(BASE64_OBJS) $(MUTTLIBS)
	$(CC) -o $@ $(BASE64_OBJS) $(MUTTLIBS) $(LDFLAGS) $(LIBS)

$(TEST_BUFFER): $(PWD)/test/buffer $(BUFFER_OBJS) $(MUTTLIBS)
	$(CC) -o $@ $(BUFFER_OBJS) $(MUTTLIBS) $(LDFLAGS) $(LIBS)

$(TEST_CHARSET): $(PWD)/test/charset $(CHARSET_OBJS) $(MUTTLIBS)
	$(CC) -o $@ $(CHARSET_OBJS) $(MUTTLIBS) $(LDFLAGS) $(LIBS)

$(TEST_CONFIG): $(PWD)/test/config $(CONFIG_OBJS) $(MUTTLIBS)
	$(CC) -o $@ $(CONFIG_OBJS) $(MUTTLIBS) $(LDFLAGS) $(LIBS)

$(TEST_DATE): $(PWD)/test/date $(DATE_OBJS) $(MUTTLIBS)
	$(CC) -o $@ $(DATE_OBJS) $(MUTTLIBS) $(LDFLAGS) $(LIBS)

$(TEST_GROUP): $(PWD)/test/group $(GROUP_OBJS) $(MUTTLIBS)
	$(CC) -o $@ $(GROUP_OBJS) $(MUTTLIBS) $(LDFLAGS) $(LIBS)

$(TEST_IDNA): $(PWD)/test/idna $(IDNA_OBJS) $(MUTTLIBS)
	$(CC) -o $@ $(IDNA_OBJS) $(MUTTLIBS) $(LDFLAGS) $(LIBS)

$(TEST_PATH): $(PWD)/test/path $(PATH_OBJS) $(MUTTLIBS)
	$(CC) -o $@ $(PATH_OBJS) $(MUTTLIBS) $(LDFLAGS) $(LIBS)

$(TEST_PATTERN): $(PWD)/test/pattern $(PATTERN_OBJS) $(MUTTLIBS)
	$(CC) -o $@ $(PATTERN_OBJS) $(MUTTLIBS) $(LDFLAGS) $(LIBS)

$(TEST_STRING): $(PWD)/test/string $(STRING_OBJS) $(MUTTLIBS)
	$(CC) -o $@ $(STRING_OBJS) $(MUTTLIBS) $(LDFLAGS) $(LIBS)

$(PWD)/test/address:
	$(MKDIR_P) $(PWD)/test/address

$(PWD)/test/base64:
	$(MKDIR_P) $(PWD)/test/base64

$(PWD)/test/buffer:
	$(MKDIR_P) $(PWD)/test/buffer

$(PWD)/test/charset:
	$(MKDIR_P) $(PWD)/test/charset

$(PWD)/test/config:
	$(MKDIR_P) $(PWD)/test/config

$(PWD)/test/date:
	$(MKDIR_P) $(PWD)/test/date

$(PWD)/test/group:
	$(MKDIR_P) $(PWD)/test/group

$(PWD)/test/idna:
	$(MKDIR_P) $(PWD)/test/idna

$(PWD)/test/path:
	$(MKDIR_P) $(PWD)/test/path

$(PWD)/test/pattern:
	$(MKDIR_P) $(PWD)/test/pattern

$(PWD)/test/string:
	$(MKDIR_P) $(PWD)/test/string

all-test: $(TEST_BINARY) $(TEST_ADDRESS) $(TEST_BASE64) $(TEST_BUFFER) $(TEST_CHARSET) $(TEST_CONFIG) $(TEST_DATE) $(TEST_GROUP) $(TEST_IDNA) $(TEST_PATH) $(TEST_PATTERN) $(TEST_STRING)

clean-test:
	$(RM) $(TEST_BINARY) $(TEST_OBJS) $(TEST_OBJS:.o=.Po) \
	      $(TEST_ADDRESS) $(ADDRESS_OBJS) $(ADDRESS_OBJS:.o=.Po) \
	      $(TEST_BASE64) $(BASE64_OBJS) $(BASE64_OBJS:.o=.Po) \
	      $(TEST_CHARSET) $(CHARSET_OBJS) $(CHARSET_OBJS:.o=.Po) \
	      $(TEST_CONFIG) $(CONFIG_OBJS) $(CONFIG_OBJS:.o=.Po) \
	      $(TEST_DATE) $(DATE_OBJS) $(DATE_OBJS:.o=.Po) \
	      $(TEST_GROUP) $(GROUP_OBJS) $(GROUP_OBJS:.o=.Po) \
	      $(TEST_IDNA) $(IDNA_OBJS) $(IDNA_OBJS:.o=.Po) \
	      $(TEST_PATH) $(PATH_OBJS) $(PATH_OBJS:.o=.Po) \
	      $(TEST_PATTERN) $(PATTERN_OBJS) $(PATTERN_OBJS:.o=.Po) \
	      $(TEST_STRING) $(STRING_OBJS) $(STRING_OBJS:.o=.Po)

install-test:
uninstall-test:

TEST_DEPFILES = $(TEST_OBJS:.o=.Po)
-include $(TEST_DEPFILES)

ADDRESS_DEPFILES = $(ADDRESS_OBJS:.o=.Po)
-include $(ADDRESS_DEPFILES)

BASE64_DEPFILES = $(BASE64_OBJS:.o=.Po)
-include $(BASE64_DEPFILES)

BUFFER_DEPFILES = $(BUFFER_OBJS:.o=.Po)
-include $(BUFFER_DEPFILES)

CHARSET_DEPFILES = $(CHARSET_OBJS:.o=.Po)
-include $(CHARSET_DEPFILES)

CONFIG_DEPFILES = $(CONFIG_OBJS:.o=.Po)
-include $(CONFIG_DEPFILES)

DATE_DEPFILES = $(DATE_OBJS:.o=.Po)
-include $(DATE_DEPFILES)

GROUP_DEPFILES = $(GROUP_OBJS:.o=.Po)
-include $(GROUP_DEPFILES)

IDNA_DEPFILES = $(IDNA_OBJS:.o=.Po)
-include $(IDNA_DEPFILES)

PATH_DEPFILES = $(PATH_OBJS:.o=.Po)
-include $(PATH_DEPFILES)

PATTERN_DEPFILES = $(PATTERN_OBJS:.o=.Po)
-include $(PATTERN_DEPFILES)

STRING_DEPFILES = $(STRING_OBJS:.o=.Po)
-include $(STRING_DEPFILES)

# vim: set ts=8 noexpandtab:
